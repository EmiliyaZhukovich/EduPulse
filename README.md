# EduPulse

EduPulse ‚Äî —ç—Ç–æ —É—á–µ–±–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞/—Å–µ—Ä–≤–∏—Å —Å –±—ç–∫–µ–Ω–¥–æ–º –Ω–∞ FastAPI + SQLAlchemy + Alembic, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ Keycloak (OIDC / OpenID Connect), –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –Ω–∞ PostgreSQL –∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–µ—Ä–≤–∏—Å–æ–º. –í—Å—ë –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Docker Compose.

## üîß –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ backend/            ‚Äî –∫–æ–¥ backend (FastAPI + –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –º–æ–¥–µ–ª–∏, –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Ç.–¥.)
‚îú‚îÄ‚îÄ frontend/           ‚Äî —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å)
‚îú‚îÄ‚îÄ keycloak/           ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è/—Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è Keycloak
‚îú‚îÄ‚îÄ docker-compose.yml  ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏/–ø—Ä–æ–¥–∞–∫—à–Ω
‚îú‚îÄ‚îÄ init-db.sh / init.sql ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ)
‚îú‚îÄ‚îÄ .env.example        ‚Äî —à–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ README.md           ‚Äî —ç—Ç–æ—Ç —Ñ–∞–π–ª

````

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

1. –°–∫–æ–ø–∏—Ä—É–π `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `DATABASE_URL`, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Keycloak –∏ —Ç.–ø.).
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Docker –∏ Docker Compose.
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã:
```bash
   docker-compose up --build -d
````

4. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ backend, —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∏ Keycloak –±—É–¥—É—Ç –∑–∞–ø—É—â–µ–Ω—ã, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞ ‚Äî –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

## üß† –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)

* –°–µ—Ä–≤–∏—Å `db` –≤ `docker-compose.yml` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—Ä–∞–∑ `postgres:15-alpine`.
* –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã `init-db.sh` / `init.sql` –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.
* –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `DATABASE_URL` —É–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î –¥–ª—è backend, –Ω–∞–ø—Ä–∏–º–µ—Ä:

  ```
  postgresql+psycopg2://postgres:postgres@db:5432/edupulse_db
  ```
* –î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º–æ–π –∏ –º–∏–≥—Ä–∞—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Alembic. –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é:

  ```bash
  docker-compose exec backend alembic revision --autogenerate -m "–æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
  docker-compose exec backend alembic upgrade head
  ```

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Keycloak

* –°–µ—Ä–≤–∏—Å `keycloak` –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.
* –í–Ω—É—Ç—Ä–∏ `keycloak/` –µ—Å—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ realm, –∫–ª–∏–µ–Ω—Ç–∞, —Ä–æ–ª–µ–π, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –¥—Ä—É–≥–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫.
* Backend (FastAPI) –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É JWT‚Äë—Ç–æ–∫–µ–Ω–æ–≤, –≤—ã–¥–∞–Ω–Ω—ã—Ö Keycloak ‚Äî —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç Single Sign‚ÄëOn (SSO) –∏ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –≥—Ä—É–ø–ø–∞–º–∏ –∏ –ø—Ä–∞–≤–∞–º–∏.
* –í `docker-compose.yml` backend –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `db`, –∏ Keycloak —Ç–∞–∫–∂–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `db`, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –∑–∞–ø—É—Å–∫–∞.

## üìÅ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í `.env` (–∫–æ–ø–∏–∏ `.env.example`) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–¥–∞–Ω—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```
DATABASE_URL=postgresql+psycopg2://postgres:postgres@db:5432/edupulse_db
KEYCLOAK_URL=http://keycloak:8080
KEYCLOAK_EXTERNAL_URL=http://localhost:8080  # –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø
KEYCLOAK_REALM=edu-realm
KEYCLOAK_CLIENT_ID=psycho-client
KEYCLOAK_CLIENT_SECRET=some-secret
# –î—Ä—É–≥–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏...
```

–ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –ø—É–±–ª–∏—á–Ω–æ ‚Äî `.env` –Ω–µ –¥–æ–ª–∂–µ–Ω –ø–æ–ø–∞—Å—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.

## üìù –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–æ–π –ë–î

* –í—Å–µ ORM‚Äë–º–æ–¥–µ–ª–∏ –æ–ø–∏—Å–∞–Ω—ã –≤ backend.
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Alembic –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –º–∏–≥—Ä–∞—Ü–∏–π —Å—Ö–µ–º—ã.
* –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –º–æ–¥–µ–ª–µ–π:

  ```bash
  docker-compose exec backend alembic revision --autogenerate -m "Add new field ..."
  docker-compose exec backend alembic upgrade head
  ```

## üß© –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ —Ä–æ–ª–∏ / –≥—Ä—É–ø–ø—ã

* –ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ –ø—Ä–∞–≤–∞ –∏ –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ Keycloak ‚Äî backend –ø—Ä–æ—Å—Ç–æ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥—Ä—É–ø–ø–∞—Ö/—Ä–æ–ª—è—Ö. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Keycloak + FastAPI.
* –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—ã –º–æ–∂–µ—Ç–µ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–ø–ø–µ—Ä—ã Keycloak, —á—Ç–æ–±—ã —Ç–æ–∫–µ–Ω —Å–æ–¥–µ—Ä–∂–∞–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥—Ä—É–ø–ø–∞—Ö/—Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∏ backend –µ—ë –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª.

##### –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã Keycloak –æ—Ç–¥–∞–≤–∞–ª –±—ç–∫–µ–Ω–¥—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≥—Ä—É–ø–ø–∞—Ö/—Ä–æ–ª—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤:
1. –ó–∞–π—Ç–∏ –≤ realm
2. –í–∫–ª–∞–¥–∫–∞ Cliens -> {realm}-client (–∫–ª–∏–µ–Ω—Ç –Ω–∞—à–µ–≥–æ realm)
3. –í–∫–ª–∞–¥–∫–∞ Client Scope -> {realm}-client-dedicated
4. Add mapper -> Group Membership
5. Name, Token Claim Name = groups

##### –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–∂–¥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–≤–æ–∏ —Ä–æ–ª–∏ - –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö –≤ –≥—Ä—É–ø–ø—ã (admins –∏–ª–∏ curators)

## ‚úÖ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø—ã –≤ Keycloak (–ª–∏–±–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã –≤ `keycloak/`).
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ `.env` —Å–æ –≤—Å–µ–º–∏ –Ω—É–∂–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏.
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `docker-compose up --build -d`.
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ backend, —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∏ Keycloak —Ä–∞–±–æ—Ç–∞—é—Ç.
5. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏, –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
6. –ú–æ–∂–Ω–æ –∑–∞—Ö–æ–¥–∏—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –ª–æ–≥–∏–Ω–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ Keycloak, –ø–æ–ª—É—á–∞—Ç—å —Ç–æ–∫–µ–Ω—ã –∏ –¥–µ–ª–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ backend.

